<!DOCTYPE html>
<html>
  <head>
    <title>image bot</title>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <!-- <link rel="stylesheet" type="text/css" href='../static/stylesheets/style.css'> -->
    
    <link rel="stylesheet" type="text/css" href="/static/style.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/markdown-it/10.0.0/markdown-it.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>



  </head>
  <body>
    <h1>image bot</h1>
    <div>
      <div id="chatbox">
        <p class="botText"><span>Hi!.</span></p>
      </div>
      <div id="userInput">
        <input id="textInput" type="text" name="msg" placeholder="Message">
        <input id="buttonInput" type="submit" value="Send">
      </div>
      <script>
        // function getBotResponse() {
        //   var rawText = $("#textInput").val();
        //   var userHtml = '<p class="userText"><span>' + rawText + '</span></p>';
        //   msg = bm25_model.find_ans(userHtml); ////////////////
        //   $("#textInput").val("");
        //   $("#chatbox").append(userHtml);  ///////////////////
        //   $("#chatbox").append(msg);
        //   document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
        //   $.get("/get", { msg: rawText }).done(function(data) {
        //     var botHtml = '<p class="botText"><span>' + data + '</span></p>';
        //     $("#chatbox").append(botHtml);
        //     document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
        //   });
        // }
        // $("#textInput").keypress(function(e) {
        //     if(e.which == 13) {
        //         getBotResponse();
        //     }
        // });
        // $("#buttonInput").click(function() {
        //   getBotResponse();
        // })
        function getBotResponse() {
          var rawText = $("#textInput").val();
          var userHtml = '<p class="userText"><span>' + rawText + '</span></p>';
          $("#textInput").val("");
          $("#chatbox").append(userHtml);
          document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
          $.get("/get", { msg: rawText }).done(function(data) {
            var botHtml = '<p class="botText"><span>' + data.Answer + '</span></p>';
            $("#chatbox").append(botHtml);
            document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
            if(data.Answer != 'not found'){
            var imagehtml='<p class="botimage"><span>' + '<img src="" width="500" height="500" id="imageBox">' + '</span></p>'
            $("#chatbox").append(imagehtml);
            document.getElementById('imageBox').src = "../static/images/text-based/"+data.image_name; 
            document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
            }

          });
        }
        $("#textInput").keypress(function(e) {
            if(e.which == 13) {
                getBotResponse();
            }
        });
        $("#buttonInput").click(function() {
          getBotResponse();
        })
      </script>
    </div>
  </body>
</html>